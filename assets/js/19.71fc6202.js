(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{298:function(e,t,n){e.exports=n.p+"assets/img/provider.8012e68d.png"},299:function(e,t,n){e.exports=n.p+"assets/img/_InheritedProviderScope.972b1dca.png"},300:function(e,t,n){e.exports=n.p+"assets/img/too_young_too_simple.8c759b85.jpeg"},338:function(e,t,n){"use strict";n.r(t);var r=n(14),i=Object(r.a)({},(function(){var e=this,t=e._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h1",{attrs:{id:"provider"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#provider"}},[e._v("#")]),e._v(" Provider")]),e._v(" "),t("p",[e._v("ä¸€ä¸ªFlutterå®˜æ–¹å›¢é˜Ÿæä¾›çš„çŠ¶æ€ç®¡ç†åº“ã€‚ä¸»è¦åŠŸèƒ½æ˜¯åœ¨æŸä¸ªèŠ‚ç‚¹ä¸ºæ‰€æœ‰å­èŠ‚ç‚¹æä¾›çŠ¶æ€å…±äº«å’ŒçŠ¶æ€æ›´æ–°ã€‚ä¸ºæˆ‘ä»¬æä¾›æ›´ä¸°å¯Œã€æ›´æ–¹ä¾¿çš„ä½¿ç”¨Inheritedæœºåˆ¶çš„æ–¹å¼ã€‚")]),e._v(" "),t("h2",{attrs:{id:"ç®€å•ä½¿ç”¨"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ç®€å•ä½¿ç”¨"}},[e._v("#")]),e._v(" ç®€å•ä½¿ç”¨")]),e._v(" "),t("ul",[t("li",[e._v("Providerï¼šæ•°æ®æä¾›è€…ã€‚Providerçš„å®é™…ç±»å‹å¾ˆå¤šï¼ŒåŠŸèƒ½ä¸Šæœ‰ä¸¤å¤§ç±»ï¼šä¸å˜å€¼å’Œå¯å˜å€¼ã€‚å¯å˜å€¼æ”¹å˜æ˜¯ä¼šé€šçŸ¥Providerä»¥åŠæ‰€æœ‰å­èŠ‚ç‚¹rebuildã€‚æ‰€ä»¥è¦æ³¨æ„Providerçš„ä½ç½®ä»¥ä¿è¯é¡µé¢æµç•…åº¦ã€‚")]),e._v(" "),t("li",[e._v("Consumerï¼šæ•°æ®æ¶ˆè´¹è€…ã€‚æœ¬èº«æ²¡æœ‰ä»€ä¹ˆé€»è¾‘ï¼Œä»…æä¾›ä¸€ä¸ª"),t("code",[e._v("context.watch")]),e._v("çš„å°è£…ã€‚")])]),e._v(" "),t("p",[e._v("æ¥ä¸ªæœ€ç®€å•çš„ğŸŒ°")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("  @override\n  Widget build(BuildContext context) {\n    return Provider(create: (BuildContext context) {\n      return 'ssss';\n    }, child: Consumer<String>(builder: (context, value, child) {\n      return Text(value);\n    }));\n  }\n")])])]),t("h2",{attrs:{id:"æµç¨‹åˆ†æ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#æµç¨‹åˆ†æ"}},[e._v("#")]),e._v(" æµç¨‹åˆ†æ")]),e._v(" "),t("h3",{attrs:{id:"æ™®é€šçŠ¶æ€"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#æ™®é€šçŠ¶æ€"}},[e._v("#")]),e._v(" æ™®é€šçŠ¶æ€")]),e._v(" "),t("p",[e._v("ä»¥Providerä¸ºğŸŒ°")]),e._v(" "),t("p",[e._v("ç»§æ‰¿å…³ç³»\n"),t("img",{attrs:{src:n(298),alt:"ç»§æ‰¿å…³ç³»"}})]),e._v(" "),t("p",[e._v("InteritedProvider")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("InheritedProvider({\n    Key? key,\n    Create<T>? create,\n    T Function(BuildContext context, T? value)? update,\n    UpdateShouldNotify<T>? updateShouldNotify,\n    void Function(T value)? debugCheckInvalidValueType,\n    StartListening<T>? startListening,\n    Dispose<T>? dispose,\n    this.builder,\n    bool? lazy,\n    Widget? child,\n  })  : _lazy = lazy,\n        _delegate = _CreateInheritedProvider(\n          create: create,\n          update: update,\n          updateShouldNotify: updateShouldNotify,\n          debugCheckInvalidValueType: debugCheckInvalidValueType,\n          startListening: startListening,\n          dispose: dispose,\n        ),\n        super(key: key, child: child);\n\n  ...\n\n  @override\n  Widget buildWithChild(BuildContext context, Widget? child) {\n    assert(\n      builder != null || child != null,\n      '$runtimeType used outside of MultiProvider must specify a child',\n    );\n    return _InheritedProviderScope<T>(\n      owner: this,\n      // ignore: no_runtimetype_tostring\n      debugType: kDebugMode ? '$runtimeType' : '',\n      child: builder != null\n          ? Builder(\n              builder: (context) => builder!(context, child),\n            )\n          : child!,\n    );\n  }\n\n")])])]),t("p",[e._v("Providerå¹¶ä¸æ˜¯InteritedWidgeçš„å­ç±»ï¼Œè€Œæ˜¯ä¸€ä¸ªSingleChildStatelessWidgetï¼Œæ‰€æœ‰æˆ‘ä»¬å¾—çœ‹"),t("code",[e._v("buildWithChild")]),e._v("æ–¹æ³•ï¼Œè¿›å…¥_InheritedProviderScopeã€‚")]),e._v(" "),t("p",[e._v("ç»§æ‰¿å…³ç³»\n"),t("img",{attrs:{src:n(299),alt:"ç»§æ‰¿å…³ç³»"}}),e._v("\nä»è¿™é‡Œå¯ä»¥çœ‹åˆ°_InheritedProviderScopeæ˜¯InteritedWidgetã€‚æˆ‘ä»¬è¿™æ˜¯å°±èƒ½é¢„çŸ¥åé¢æŸ¥æ‰¾Elementæ˜¯ç”¨çš„å°±æ˜¯_InheritedProviderScopeã€‚è¿™ä¸ªç±»æœ¬èº«å¹¶æ²¡æœ‰å•¥é€»è¾‘ï¼Œç›´æ¥æ¥_InheritedProviderScopeElementã€‚ä¾æ®Interitedçš„è®¾è®¡ï¼Œ_InheritedProviderScopeElementå¿…ç„¶æ˜¯InheritedElementçš„å­ç±»ã€‚")]),e._v(" "),t("p",[e._v("_InheritedProviderScopeElement")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("  @override\n  bool get hasValue => _delegateState.hasValue;\n\n  @override\n  void markNeedsNotifyDependents() {\n    if (!_isNotifyDependentsEnabled) {\n      return;\n    }\n\n    markNeedsBuild();\n    _shouldNotifyDependents = true;\n  }\n\n  @override\n  void performRebuild() {\n    if (_firstBuild) {\n      _firstBuild = false;\n      _delegateState = widget.owner._delegate.createState()..element = this;\n    }\n    super.performRebuild();\n  }\n")])])]),t("p",[e._v("åœ¨è¿™é‡ŒpreformRebuildåšäº†ä¸¤ä»¶äº‹ï¼š")]),e._v(" "),t("ol",[t("li",[e._v("å®ä¾‹åŒ–äº†_delegateStateã€‚")]),e._v(" "),t("li",[e._v("å°†è‡ªèº«çš„å¼•ç”¨ç»™_delegateStateã€‚\nåˆ°è¿™é‡Œå¹¶æ²¡æœ‰ç”Ÿäº§æˆ‘ä»¬éœ€è¦çš„å€¼ï¼Œä¹Ÿå°±æ˜¯è¯´æ²¡æœ‰ä½¿ç”¨æˆ‘ä»¬ä¼ é€’ç»™Providerçš„createçš„é‚£ä¸ªå‡½æ•°å¯¹è±¡ã€‚Provideræ ‘çš„ç”Ÿæˆéƒ¨åˆ†å°±ç»“æŸäº†ï¼Œä¸‹é¢è€ƒè™‘å­æ ‘çš„ç”Ÿæˆè¿‡ç¨‹ã€‚")])]),e._v(" "),t("p",[e._v("Consumerï¼šæœ¬èº«æ˜¯SingleChildStatelessWidgetï¼Œå¾ˆç®€å•ã€‚")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("  @override\n  Widget buildWithChild(BuildContext context, Widget? child) {\n    return builder(\n      context,\n      Provider.of<T>(context),\n      child,\n    );\n  }\n")])])]),t("p",[t("code",[e._v("Provider.of<T>(context)")]),e._v("æµç¨‹ï¼š")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("  static T of<T>(BuildContext context, {bool listen = true}) {\n  \n    final inheritedElement = _inheritedElementOf<T>(context);\n\n    if (listen) {\n      context.dependOnInheritedElement(inheritedElement);\n    }\n    return inheritedElement.value;//é‡ç‚¹åˆ†æï¼Œè¿™é‡Œä¼šåˆ°\n  }\n\n  ...\n\n    static _InheritedProviderScopeElement<T> _inheritedElementOf<T>(\n    BuildContext context,\n  ) {\n    _InheritedProviderScopeElement<T>? inheritedElement;\n\n    if (context.widget is _InheritedProviderScope<T>) {\n      // An InheritedProvider<T>'s update tries to obtain a parent provider of\n      // the same type.\n      context.visitAncestorElements((parent) {\n        inheritedElement = parent.getElementForInheritedWidgetOfExactType<\n            _InheritedProviderScope<T>>() as _InheritedProviderScopeElement<T>?;\n        return false;\n      });\n    } else {\n      inheritedElement = context.getElementForInheritedWidgetOfExactType<\n          _InheritedProviderScope<T>>() as _InheritedProviderScopeElement<T>?;\n    }\n\n    if (inheritedElement == null) {\n      throw ProviderNotFoundException(T, context.widget.runtimeType);\n    }\n\n    return inheritedElement!;\n  }\n")])])]),t("p",[t("code",[e._v("inheritedElement.value")]),e._v(" => "),t("code",[e._v("_InheritedProviderScopeElement:_delegateState.value")]),e._v("=>"),t("code",[e._v("_DelegateState:T get value;")]),e._v("å¦‚æœä»¥Providerçš„é»˜è®¤æ„é€ æ–¹æ³•ä¸ºä¾‹çš„è¯å°±æ˜¯"),t("code",[e._v("_CreateInheritedProviderState:")])]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("@override\n  T get value {\n    if (_didInitValue && _value is! T) {\n      throw StateError(\n        'Tried to read a provider that threw during the creation of its value.\\n'\n        'The exception occurred during the creation of type $T.',\n      );\n    }\n    bool? _debugPreviousIsInInheritedProviderCreate;\n    bool? _debugPreviousIsInInheritedProviderUpdate;\n\n    if (!_didInitValue) {\n      _didInitValue = true;\n      if (delegate.create != null) {\n        try {\n          _value = delegate.create!(element!);//è¿™é‡Œè°ƒç”¨æˆ‘ä»¬ä¼ å…¥çš„æ–¹æ³•å¯¹è±¡ï¼Œå®˜æ–¹æ–‡æ¡£çš„æ‡’åŠ è½½å°±ä½“ç°åœ¨è¿™é‡Œã€‚å€¼åœ¨ç”¨åˆ°çš„æ—¶å€™æ‰åˆå§‹åŒ–ã€‚\n        } finally {\n          \n        }\n      }\n      if (delegate.update != null) {\n        //å…ˆä¸ç®¡\n      }\n    }\n\n    element!._isNotifyDependentsEnabled = false;\n    _removeListener ??= delegate.startListening?.call(element!, _value as T);//è¿™é‡Œåé¢ä¼šç”¨åˆ°ã€‚\n    element!._isNotifyDependentsEnabled = true;\n    assert(delegate.startListening == null || _removeListener != null);\n    return _value as T;\n  }\n")])])]),t("p",[e._v("åˆ°è¿™é‡Œæ•´ä¸ªProvideræµç¨‹å°±ç»“æŸäº†ã€‚")]),e._v(" "),t("p",[e._v("ä»¥ä¸ºå®Œäº†å—ï¼Ÿï¼Ÿï¼Ÿ\n"),t("img",{attrs:{src:n(300),alt:""}})]),e._v(" "),t("h2",{attrs:{id:"listenableprovider"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#listenableprovider"}},[e._v("#")]),e._v(" ListenableProvider")]),e._v(" "),t("p",[e._v("ä¸€ä¸ªå®Œç¾çš„å“åº”å¼ï¼Œå½“æ•°æ®æ”¹å˜ï¼Œç•Œé¢éšå³æ”¹å˜ï¼Œä¸éœ€è¦é¢å¤–æ“ä½œã€‚è¿™é‡Œä»¥ListenableProviderä¸ºä¾‹åˆ†æï¼Œå…¶ä»–å¦‚ChangeNotifierProviderã€FutureProviderã€StreamProviderã€ValueListenableProvideråŸç†ç±»ä¼¼ã€‚")]),e._v(" "),t("p",[e._v("ListenableProvider")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("//æ„é€ æ–¹æ³•å¤šä¸ªä¸€ä¸ªä¸œè¥¿_startListeningã€‚\n  ListenableProvider({\n    Key? key,\n    required Create<T> create,\n    Dispose<T>? dispose,\n    bool? lazy,\n    TransitionBuilder? builder,\n    Widget? child,\n  }) : super(\n          key: key,\n          startListening: _startListening,\n          create: create,\n          dispose: dispose,\n          lazy: lazy,\n          builder: builder,\n          child: child,\n        );\n  ...\n\n  static VoidCallback _startListening(\n    InheritedContext e,\n    Listenable? value,\n  ) {\n    value?.addListener(e.markNeedsNotifyDependents);\n    return () => value?.removeListener(e.markNeedsNotifyDependents);\n  }\n")])])]),t("p",[e._v("å¾€å›çœ‹ï¼Œåœ¨_CreateInheritedProviderStateçš„value getä¸­ï¼Œä¼šè°ƒç”¨_startListeningè¿™ä¸ªæ–¹æ³•ã€‚ä¸‹é¢çœ‹çœ‹markNeedsNotifyDependentsæ˜¯ä»€ä¹ˆï¼Œè¿˜æ˜¯å¾€å›å€’InheritedProviderScopeElementçš„ä»£ç ä¸­ï¼ŒmarkNeedsNotifyDependents()=ã€‹markNeedsBuild(),ç³»ç»Ÿæ–¹æ³•ï¼Œæ ‡è®°ä¸‹å¸§é‡ç»˜ã€‚é‚£ä¹ˆå“åº”å¼çš„åˆ°æ­¤ç»“æŸã€‚Futureå’ŒStreamçš„ç±»ä¼¼ï¼Œåªä¸è¿‡ä¸æ˜¯å›è°ƒæ–¹å¼ä¸ä¸€æ ·ã€‚")]),e._v(" "),t("h2",{attrs:{id:"proxyprovider"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#proxyprovider"}},[e._v("#")]),e._v(" ProxyProvider")]),e._v(" "),t("p",[e._v("åœ¨å‰é¢_CreateInheritedProviderStateä»£ç valueè·å–çš„æµç¨‹å¯ä»¥å‘ç°ï¼Œä¸€å—é‡è¦çš„é€»è¾‘æ˜¯delegate.updateï¼Œè¿™ä¸ªå±æ€§ä¸€ç›´æ²¡æœ‰èµ‹å€¼ã€‚è¿™ä¸ªå€¼åœ¨ProxyProviderä¼šè¢«èµ‹å€¼ã€‚æµç¨‹ä¸Šä¾é™„äºç­¾åçš„æµç¨‹å°±å¾ˆç®€å•äº†ã€‚ä¸»è¦è¯´æ˜ä¸‹ProxyProviderçš„è®¾è®¡ç›®çš„ï¼Œå½“ä¸€ä¸ªProviderçš„å€¼ä¾èµ–äºå¦ä¸€ä¸ªProvideræ—¶ï¼Œä½¿ç”¨ProxyProviderå¯ä»¥æ–¹ä¾¿çš„åšåˆ°é¡µé¢æ›´æ–°(ä¹Ÿä¸æ˜¯å¾ˆæ‡‚ï¼)ã€‚")])])}),[],!1,null,null,null);t.default=i.exports}}]);